S←{𝕩-˜↕2×𝕩}
C←{𝕊x‿y‿r:∾{𝕩{𝕨‿𝕩+x‿y}¨S ⌊√r-○(×˜)𝕩}¨S r}
_f←{(𝕗¨)⌾(𝕨⊸⊑)𝕩}
R←{𝕨+b×↕1+(b←×a)×a←𝕩-𝕨}
L←{
  x0‿y0 𝕊 x1‿y1:
  dx‿dy←𝕩-𝕨
  d←(2×dy)-dx
  y←¯1⊑𝕨
  {r←𝕩⋈y,{d>0?y+↩1,d↩d-2×dx;0},d+↩2×dy,r}¨x0 R x1
}
{
  g←((136‿240⥊0)⌈110‿26/10‿6){(C (5+⌊20×2⋆𝕨)‿120‿(⌊12×1.7⋆𝕨))12 _f 𝕩}´↕3
  g↩(C 20‿125‿2) 0 _f (C 20‿115‿2) 0 _f g
  g↩(C 25‿120‿3) 3 _f g
  g↩(30‿115 L 34‿121) 0 _f g
  g↩(33‿120 L 30‿125) 0 _f g
  g↩g{(C (45+𝕨×20)‿120‿3)0 _f 𝕩}´↕4
  g↩(45‿135 L 25‿200) 0 _f g
  g↩(26‿90 L 45‿105) 0 _f g
  (<˘⍉136‿240 |𝕨+30‿7×≍˜↕100) 12 _f g
}
